# 构建大型网站：分布式改造

## 为什么要做分布式化

所谓分布式改造就是尽量让系统无状态化，以利于季候的扩展。

实现应用的分布式改造先解决好一下几个问题：

+ 应用需要微服务化
+ 必须先建立分布式服务框架
+ 必须解决状态一致性问题

## 典型的分布式架构

分布式架构VS传统的单机架构的区别在于分布式架构能解决两个方向的扩展问题：

+ 横向扩展：主要用来解决应用架构上的容量问题
+ 纵向扩展：主要解决业务的扩展问题。

1. 需要分布式中间件
2. 服务化和分布式化

## 分布式配置框架

两种管理模式：

1. 拉取模式。客户端主动向服务器询问配置信息是否有更新，如果有则拉取信息更新自己。缺点：服务器没法主动及时推送更新信息。（使用场景：客户端很多）
2. 推送模式：服务器主动把信息推送给每个客户端。缺点：服务器必须感知每个可兑换的状态，管理难度大。（使用场景：对配置下方延时率比较敏感，且客户端不是很多）

![image-20200415221103609](https://gitee.com/hfqy/picture_bed/raw/master/img/20200415221110.png)

必须考虑的问题：

1. 不要让服务器的网卡成为瓶颈，尤其是下发的数据量较大时
2. 要保证配置下发的到达率

## 分布式RPC框架

![image-20200415222051306](https://gitee.com/hfqy/picture_bed/raw/master/img/20200415222057.png)

1. 服务注册
2. 服务发现
3. 服务调度和负载均衡
4. 统一的SDK封装

 ## 分布式消息框架

1. 实时消息
   	1. 异步解耦
    	2. 多消费者

2. 延时消息
3. [常见的消息中间件](http://queus.io)
4. [几种常见的消息中间件对比](https://my.oschina.net/blogByRzc/blog/3012251)

## 分布式数据层

1. 分库分表
2. 主备读写分离

## 分布式文件系统

[分布式文件系统概念](https://www.cnblogs.com/wwchihiro/p/9242542.html)

[各种分布式文件系统比较](https://blog.csdn.net/baiducheng/article/details/78210752)

[文件存储系统基本架构](https://zhuanlan.zhihu.com/p/27666295)

## 应用的服务化改造

1. 应用分层设计
2. 微服务化

[Spring Boot 基础](https://www.ibm.com/developerworks/cn/java/j-spring-boot-basics-perry/index.html)

## 分布式化遇到的典型问题

[ZooKeeper官网](http://zookeeper.apache.org/)

[Zookeeper 教程](https://www.w3cschool.cn/zookeeper/)

1. 集群管理
2. 共享锁
3. 队列管理

## 分布式消息通道服务的设计

## 典型的分布式集群设计思路

+ Master/Slave模式
+ 无对等

# 无线化：无线时代下的架构演进

